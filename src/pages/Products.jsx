// ๐น ูุงุฑุฏ ฺฉุฑุฏู ุฏุงุฏูโ ูุญู (ุฏุฑ ุตูุฑุช ูุงุฒ ุจู Mock Data)
import productData from "../data/products";

// ๐น ูุงุฑุฏ ฺฉุฑุฏู axios ุจุฑุง ุฏุฑุฎูุงุณุช ุจู API ูุงูุน
import axios from "axios";

// ๐น ููฺฉโูุง useState ู useEffect ุจุฑุง ูุถุนุช ู ฺุฑุฎูโ ุญุงุช
import { useState, useEffect } from "react";

// ๐น ฺฉุงููพูููุชโูุง ูุฑุจูุท ุจู ููุงุด
import ProductCard from "../components/ProductCard"; // ฺฉุงุฑุช ูุฑ ูุญุตูู
import Loader from "../components/Loader"; // ููุฏุฑ ุจุฑุง ููุงุด ููฺฏุงู ุจุงุฑฺฏุฐุงุฑ
import Skeleton from "../components/Skeleton"; // ุงุณฺฉูุชโููุง (ูุญู ูููุช ุจุฑุง ูุญุตูู)

// ๐ ฺฉุงููพูููุช ุงุตู ุตูุญู ูุญุตููุงุช
export default function Products() {
  // ๐ฆ ุชุนุฑู stateโูุง (ูุถุนุชโูุง ุฏุงุฎู ฺฉุงููพูููุช)
  // products: ุขุฑุงู ูุญุตููุงุช
  // loading: ูุถุนุช ุจุงุฑฺฏุฐุงุฑ (ุฏุฑ ุญุงู ุฏุฑุงูุช ุง ุฎุฑ)
  // error: ูุถุนุช ุฎุทุง ููฺฏุงู ุฏุฑุงูุช
  const [products, setProducts] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);

  // ๐ useEffect: ููุท ฺฉโุจุงุฑ ุจุนุฏ ุงุฒ ุฑูุฏุฑ ุงููู ุงุฌุฑุง ูโุดูุฏ
  useEffect(() => {
    // ุชุงุจุน async ุจุฑุง ุฏุฑุงูุช ุฏุงุฏู ุงุฒ ุณุฑูุฑ (ุง ููุจุน ุฌุนู)
    async function fetchProduct() {
      try {
        setLoading(true); // ูุจู ุงุฒ ุดุฑูุน ุฏุฑุฎูุงุณุชุ ูุถุนุช ุฑุง ุฏุฑ ุญุงู ุจุงุฑฺฏุฐุงุฑ ูุฑุงุฑ ูโุฏูู

        // ๐ก ุฏุฑุฎูุงุณุช ูุงูุน ุจู API ุงูุชุฑูุช
        const response = await axios.get("https://fakestoreapi.com/products");
        setProducts(response.data); // ุฐุฎุฑู ุฏุงุฏูโูุง ุฏุฑ state

        // ๐ธ ุฏุฑ ุตูุฑุช ุขููุงู ุจูุฏู ุณุฑูุฑุ ูโุชูุงู ุฌุงฺฏุฒู ูููุช ุงุณุชูุงุฏู ฺฉุฑุฏ:
        // setProducts(productData);
      } catch (error) {
        // ุงฺฏุฑ ุฏุฑ ฺฏุฑูุชู ุฏุงุฏูโูุง ุฎุทุง ุฑุฎ ุฏูุฏ:
        setError("error fetching data"); // ุซุจุช ูพุบุงู ุฎุทุง ุฏุฑ state

        // ุฏุฑ ุขููุฒุด ุง ุญุงูุช ุชุณุชุ ูโุชูุงู Mock Data ุฌุงฺฏุฒู ฺฉุฑุฏ
        // setProducts(productData);
      } finally {
        // โ ุฏุฑ ูพุงุงู (ฺู ุฎุทุงุ ฺู ููููุช) ุจุนุฏ ุงุฒ ฺฉู ุชุฃุฎุฑุ ุจุงุฑฺฏุฐุงุฑ ูุชููู ูโุดูุฏ
        setTimeout(() => {
          setLoading(false);
        }, 2000);
      }
    }

    // ูุฑุงุฎูุงู ุชุงุจุน ุจุงูุง ุจูุงูุงุตูู ุจุนุฏ ุงุฒ ุจุงุฑ ุงูู Mount ุดุฏู ฺฉุงููพูููุช
    fetchProduct();
  }, []); // ูุงุจุณุชฺฏ ุฎุงู ุนู ููุท ฺฉ ุจุงุฑ ููฺฏุงู Load ุตูุญู ุงุฌุฑุง ุดูุฏ

  // ๐ก ุญุงูุชโูุง ูุฎุชูู ููุงุด ุจุฑุง UX ุจูุชุฑ:

  // ุงฺฏุฑ ุฏุฑ ุญุงู ุจุงุฑฺฏุฐุงุฑ ุงุณุชุ ุงุณฺฉูุช ุง ููุฏุฑ ููุงุด ุฏูุฏ
  if (loading)
    return (
      <div>
        <Skeleton width={200} height={20} /> {/* ุดุจูโุณุงุฒ ุนููุงู */}
        <Skeleton width={400} height={100} /> {/* ุดุจูโุณุงุฒ ฺฉุงุฑุช */}
        <Skeleton width={200} height={20} /> {/* ุฏูุจุงุฑู ุนููุงู ุง ูุชู */}
      </div>
    );

  // ุงฺฏุฑ ุฎุทุง ุฑุฎ ุฏุงุฏูุ ูพุงู ูุฑูุฒ ูุดุงู ูโุฏูุฏ
  if (error) return <p style={{ color: "red" }}>{error}</p>;

  // โ ุญุงูุช ููุง: ุฒูุงู ฺฉู ุฏุงุฏู ููุฏ ู ุขูุงุฏูโ ููุงุด ุงุณุช
  return (
    <div>
      <h2>Product page</h2>

      {/* ูุงุญู ููุงุด ฺฉุงุฑุชโูุง ูุญุตููุงุช */}
      <div
        style={{
          display: "grid", // ููู ฺฉุงุฑุชโูุง ุฏุฑ ฺุฏูุงู ุดุจฺฉูโุง ููุงุด ุฏุงุฏู ุดููุฏ
          gap: "20px", // ูุงุตูู ุจู ฺฉุงุฑุชโูุง
          marginTop: "20px",
        }}
      >
        {/* map ฺฉุฑุฏู ุฏุงุฏูโูุง */}
        {products.map((p) => (
          <ProductCard key={p.id} product={p} />
        ))}
      </div>
    </div>
  );
}
